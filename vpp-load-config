#!/bin/bash
CONFIG_FILE="/etc/vpp/klish-startup.conf"
[ ! -f "$CONFIG_FILE" ] && exit 0
echo "Loading VPP config..."
while IFS= read -r line || [ -n "$line" ]; do
    # Skip comments and empty lines
    [[ "$line" =~ ^[[:space:]]*# ]] && continue
    [[ -z "${line// }" ]] && continue
    echo "Exec: $line"
    # Use -c to pass entire line as single command
    vppctl -s /run/vpp/cli.sock "$line"
done < "$CONFIG_FILE"
echo "Done"
